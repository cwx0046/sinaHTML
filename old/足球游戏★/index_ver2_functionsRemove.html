<!DOCTYPE html>
<html>
<head>
<meta charset="GB2312">
<meta http-equiv="cache-control" content="no-cache"/>
<meta name="format-detection" content="telephone=no"/>
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
<title>国足我来帮你射门</title>
<meta name="keywords" content="小游戏,足球,射门,新浪江苏" />
<meta name="description" content="国足我来帮你射门" />
<meta name="author" content="NorthWind" />
<link rel="stylesheet" href="http://jiangsu.sinaimg.cn/zt/s/css/reset.css">
<script type="text/javascript" src="http://jiangsu.sinaimg.cn/js/jquery_1.11.2.min_jsonp.js"></script>
<script src="http://jiangsu.sinaimg.cn/js/jquery.transit.min.js"></script>
<!-- 
<script src="http://jiangsu.sinaimg.cn/js/jquery1.11.1.min.js"></script>
<script src="http://ria.city.sina.com.cn/s/g=base.js" type="text/javascript"></script>
 -->
<!-- 自适应缩放css -->
<style type="text/css">

.startBtn,.page2Btn,.wrap,.btn,img{-moz-user-select: none; -webkit-user-select: none; -ms-user-select: none; user-select: none;-webkit-tap-highlight-color: transparent; tap-highlight-color: transparent; }

body{ overflow: hidden; max-width: 500px; margin: 0 auto; background-color: #62af24; font-family: "Microsoft yahei"; }
.swiper-container{ width: 640px; height:1008px; position:fixed; -webkit-transform-origin: top left; transform-origin: top left; background-image: url("http://s3img.city.sina.com.cn/activity/common/large/8b7a60b4b8a5704014ec1f66d65b2c56.png"); background-repeat: no-repeat; }
.wrap{ position: absolute; width: 100%; height: 100%; left: 0; top: 0; -webkit-transform: translateZ(0);-moz-transform: translateZ(0);-ms-transform: translateZ(0);transform: translateZ(0);}
.cp{ cursor: pointer; }
.page{ position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-repeat: no-repeat; }
.btn { display: inline-block; width: 213px; height: 65px; line-height: 65px; border-radius: 10px; background-color: #f75953; color: #FFF; font-size: 24px; text-align: center; }

</style>
<style type="text/css">
.titileimg{ display: block; margin: 0px auto 0; }
.helpBtn{ display: block; margin: 24px auto 0; }
.page2Btn{ position: absolute; top:666px; left: 249px; width: 176px; height: 162px; }
.popup1{ position: absolute; width: 456px; height: 216px; top: 0; right: 0; bottom: 0; left: 0; margin: auto; background-image: url("http://s3img.city.sina.com.cn/activity/common/large/e3997192346d9d3d3003e4e659a8ecd9.png"); }
.popup3{ position: absolute; width: 412px; height: 216px; top: 0; right: 0; bottom: 0; left: 0; margin: auto; background-color: RGBA(0,0,0,0.8); font-size: 59px; color: #FFF; text-align: center; line-height: 3em; border-radius: 27px; }
.popup1 .text{ width: 367px; margin: 52px auto 0; color: #471b01; font-family: "微软雅黑"; font-size: 24px;}
#p1 .text{ text-align: center; margin-top: 95px; line-height: 1.6em; color: #20436B; text-shadow: 0 0 16px #FFF;}

/* #p2 */
.imgArrow{ position: absolute; left: 400px; top: 328px; }
.imgArrowText{ position: absolute; left: 520px; top: 232px; }
.characterBox{ text-align: center; width: 470px; margin: 626px auto 0; }
.springBox{ position: absolute;  top: 80px;  left: 108px;  width: 331px;  height: 185px; /* background-color: RGBA(255,0,0,0.5); */ }
.time{ position: absolute; top: 32px; right: 41px; font-size: 26px; color: #000; }
.time:BEFORE{ content: "剩余时间: "; }
.time:AFTER{ content: "秒"; }


.dotting {
    display: inline-block; min-width: 5px; min-height: 5px;
    box-shadow: 5px 0 currentColor, 18px 0 currentColor, 32px 0 currentColor; 
    -webkit-animation: dot 2s infinite step-start both;
    animation: dot 2s infinite step-start both; 
    *zoom: expression(this.innerHTML = '...'); /* IE7 */
}
:root .dotting { margin-right: 20px; } /* IE9+,FF,CH,OP,SF */

@-webkit-keyframes dot {
    25% { box-shadow: none; }
    50% { box-shadow: 5px 0 currentColor; }
    75% { box-shadow: 5px 0 currentColor, 18px 0 currentColor; }
}
@keyframes dot {
    25% { box-shadow: none; }
    50% { box-shadow: 5px 0 currentColor; }
    75% { box-shadow: 5px 0 currentColor, 18px 0 currentColor; }
}

@keyframes fog_flow{
  0% {
    opacity:0;
    transform:  translate(0px,0px)  ;
  }
  23% {
    opacity:0.1;
  }
  40% {
    opacity:0.27;
  }
  63% {
    opacity:0.1;
  }
  100% {
    opacity:0.2;
    transform:  translate(0px,-100px)  ;
  }
}

@-webkit-keyframes fog_flow {
  0% {
    opacity:0;
    -webkit-transform:  translate(0px,0px)  ;
  }
  23% {
    opacity:0.1;
  }
  40% {
    opacity:0.27;
  }
  63% {
    opacity:0.1;
  }
  100% {
    opacity:0.2;
    -webkit-transform: translate(0px,-100px)  ;
  }
}



.man{
  -webkit-transform-origin: 50% 50%;
  -webkit-animation: man_into_water cubic-bezier(.36,.75,.44,1.49) 0.5s;
  -webkit-animation-iteration-count: 1;
  transform-origin: 50% 50%;
  animation: man_into_water cubic-bezier(.36,.75,.44,1.49) 0.5s;
  animation-iteration-count: 1;
}

@keyframes man_into_water{
  0% {
    opacity:0;
    transform: scale(0.2) translate(0px,422px)  ;
  }
  36% {
    opacity:1;
    transform: scale(1);
  }
  100% {
    opacity:1;
    transform:  translate(0px,0px)  ;
  }
}

@-webkit-keyframes man_into_water {
  0% {
    opacity:0;
    -webkit-transform: scale(0.2) translate(0px,422px);
  }
  36% {
    opacity:1;
    -webkit-transform: scale(1);
  }
  100% {
    opacity:1;
    -webkit-transform:  translate(0px,0px)  ;
  }
}

#p1{ background-image: url("http://s3img.city.sina.com.cn/activity/common/large/239ec59c1a8027c0fcdc672377b39247.jpg"); }
#p2{ background-image: url("http://s3img.city.sina.com.cn/activity/common/large/4a6f1818a7877d1a409e824fc68840e8.jpg"); background-position: center; }

#p2, #p3, .popup, #wrap_1, #wrap_3 { display: none; }
.popup{ width: 430px;  height: 698px;  background-color: #306d00;  top: 0;  right: 0;  bottom: 0; left: 0;  margin: auto;  position: absolute;  padding: 3em; }
.popup .text{   font-size: 30px;  font-weight: bold;  color: #FFF;  padding: 27px 60px 31px;  line-height: 52px; }
.btn{ font-size: 24px; font-weight: bold; color: #FFF; text-align: center; width: 190px;height: 62px;border-radius: 5px;background-clip: padding-box;background-color: RGBA(229,0,17,0.8); cursor: pointer;}
#user_tel{ width: 313px; height: 43px; font-size: 30px; color: #061800; background-color: RGBA(255,255,255,0.8); -webkit-appearance: none; border: none;  width: 100%; margin-bottom: 1.12em; }
.actdetail_btn{ text-decoration: underline;  font-size: 28px;  position: absolute;  right: 30px;  bottom: 6%;  color: #FFF;  text-shadow: 0 2px 0 #383838;}
.again_btn{ margin-left: 26px; }
.pop1{ height: 610px; }
.popup .text1, .popup .text2{ text-align: center;  font-size: 38px;  color: #FFF;}
.popup .text1{ margin-bottom: 0.6em; }
.popup .text2{   text-align: left; font-size: 25px; line-height: 1.6em; margin-bottom: 1em; }
.qiumen{ position: absolute;  top: 4px;  left: 100px;  -webkit-transform: scaleY(-1);  transform: scaleY(-1); }
</style>
</head>
<body ontouchmove="event.preventDefault()"> <!-- 阻止ios浏览器整页上下滑动 -->
<img alt="ico" style="position:absolute; top: -400px;" src="http://s3img.city.sina.com.cn/activity/common/large/15733f326f7b76b691c272cc9a6465f3.jpg">
<!-- BGM DOM -->
<audio id="bgm" src="" autoplay="autoplay" loop style="display: none; width: 0; height: 0;"></audio>
<!-- Touch to play BGM. JS -->
<script type="text/javascript">
/* @20141215  Add first-touch check. */
var firstTouch = true;
$('body').bind("touchstart",function(e){
  if ( firstTouch ) {
    firstTouch = false;
    document.getElementById('bgm').play();
  }else{
    return;
  }
});
</script>
  <!-- 
  * 说明：
  * 单长页面
  * 页面 640 按宽度缩放
  *
   -->
  <div class="swiper-container" >
    <div class="page" id="p1">
      <!-- <img class="helpBtn cp" src="http://jiangsu.sinaimg.cn/zt/s/2014hsgame/images/e1_2.png" onclick="$('#wrap_1').fadeIn(200);"> -->
      <div class="page2Btn cp" onclick="page2();"></div>
      <!-- <div class="actdetail_btn cp" onclick="$('#wrap_1').fadeIn();">游戏规则</div> -->
    </div>
  
    <div class="page startBtn cp" id="p2">
    </div>

    <div class="page" id="p3">
      <div class="characterBox">
        <!-- 动态在此插入 -->
        <img class="ico cp" sid="1" src="http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png">
        <img class="ico cp" sid="2" src="http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png">
        <img class="ico cp" sid="3" src="http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png">
        <img class="ico cp" sid="4" src="http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png">
        <img class="ico cp" sid="5" src="http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png">
        <img class="ico cp" sid="6" src="http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png">
        <img class="ico cp" sid="7" src="http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png">
        <img class="ico cp" sid="8" src="http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png">
      </div>
      <img class="qiumen" alt="球门" src="http://s3img.city.sina.com.cn/activity/common/large/fcfc7c53a3af7694189ff0f6d65adf7c.png">
      <div class="springBox">
      
        <!-- 汤池 -->
      
      </div>
      <!-- <img class="fog" src="http://jiangsu.sinaimg.cn/zt/s/2014hsgame/images/e2_3.png"> -->
      <div class="time"></div>
    </div>
    
    <div class="wrap cp" id="wrap_1" onclick="$('#wrap_1').fadeOut(200);">
      <div class="popup1">
        <div class="text">
          3月31日，在南京奥体，国足VS突尼斯，选择你喜欢的球员上场，15秒内尽可能多的将球踢进球门，手快者将有机会赢取当日球票！
        </div>
      </div>
    </div>
    
    
    <!-- 游戏结束弹窗1 -->
    <div class="popup pop1">
      <div class="text1">恭喜您帮国足踢进<span class="score"></span>球<br/>封您为奥体球神！</div>
      <div class="text2">留下您的手机号，并关注 <span style="color:#FF2121; font-weight: bold;">南京同城会</span><br/> <span style="font-size: 19px;">( njtongchenghui )</span>，将有机会赢取当日球票！分享传达您的战绩吧～</div>
      <img alt="同城会QRcode" width="260" style="display:block; margin:0 auto; margin-bottom: 2.12em;" src="http://s3img.city.sina.com.cn/activity/common/large/78c463d7cfaa12269d287db3a3105c7a.jpg" style="display: block; margin: 0 auto;">
      <div class="again_btn btn" onclick="onceAgain()">再来一次</div>
      <div class="rankingList_btn btn" id="subscribeweixiBtn">戳我加关注</div>
    </div>
    <!-- end游戏结束弹窗1 -->
    <!-- 游戏结束弹窗2 -->
    <div class="popup pop2">
      <div class="text1">恭喜您帮国足踢进<span class="score"></span>球<br/>封您为奥体球神！</div>
      <div class="text2">留下您的手机号，并关注 <span style="color:#FF2121; font-weight: bold;">南京同城会</span><br/> <span style="font-size: 19px;">( njtongchenghui )</span>，将有机会赢取当日球票！分享传达您的战绩吧～</div>
      <img alt="同城会QRcode" width="260" style="display:block; margin:0 auto; margin-bottom: 2.12em;" src="http://s3img.city.sina.com.cn/activity/common/large/78c463d7cfaa12269d287db3a3105c7a.jpg" style="display: block; margin: 0 auto;">
      <input id="user_tel" type="tel" placeholder="轻击此处输入手机号">
      <div class="again_btn btn" onclick="onceAgain()">再来一次</div>
      <div class="submit_btn btn">提交</div>
    </div>
    <!-- end游戏结束弹窗2 -->
    
<!-- 正在提交界面 -->
<div class="wrap" id="wrap_3" >
  <div class="popup3">
    正在提交<span class="dotting"></span>
  </div>
</div>
    
        
<!-- 弹出页 -->
<style>
.weixinCover{   display: none;     position: absolute; top: 0; left: 0; width: 100%; height: 100%; color:#FFF; background-color: RGBA(0,0,0,0.9); -webkit-transform: translateZ(0); -moz-transform: translateZ(0); -ms-transform: translateZ(0); transform: translateZ(0); }
.weixinCover .arrow{ position: absolute; top: 4px; right: 30px; }
.weixinCover .continer{ position: absolute;top: 0;right: 0;bottom: 0;left: 0;margin: auto;width: 540px;height: 620px; }
.weixinCover .continer .text{ font-size: 24px;text-align: center; color: #FFF; font-weight: bold; margin: 46px auto 30px; height: 425px;  overflow-y: scroll;}
.top20List li { line-height: 1.6em;}
.no { margin: 0 10px; width:34px; text-align:right; display: inline-block;}
.u_phone{ width: 200px; display: inline-block; }
.u_score{ width: 100px; display: inline-block; text-align: right; }
</style>
<div class="weixinCover">
  <!-- 微信诱导分享 <img class="arrow" width="156" src="http://jiangsu.sinaimg.cn/zt/s/2014hsgame/images/e3_3.png"> -->
  <style>
  .top20Title{ text-align: center; font-size: 30px; font-weight: bold; color: #FFF;  margin-top: 105px; }
  .top20Title .t1{ color: #e60012; font-size: 48px; }
  .top20Title .t3{ color: #e60012; }
  </style>
  <div class="continer">
    <div class="top20Title">
      <p class="t1">游戏结束！</p>
      <p>感谢你在15秒内 帮国足踢进<span class="score"></span>球！</p>
      <!-- <p class="t3">TOP20</p> -->
    </div>
    <!-- 排行榜被移除 -->
    <!-- 
    <div class="text" ontouchmove="event.stopPropagation()">
        <ol class="top20List">
          <li>Loading...</li>
        </ol>
    </div>
     -->
    
    <div style="text-align: center;">
      <div class="btn" id="subscribeweixiBtn">关注我们</div>
    </div>
  </div>
</div>
    
    
    
  </div>
</body>
<!-- page Auto scale -->
<script type="text/javascript">
  $(function() {
    pageAutoScale();
  });
  $(window).resize(function() {
    pageAutoScale();
  });
  
  function pageAutoScale(){
    var r = document.body.offsetWidth / 640;
    $(".swiper-container").css({"-webkit-transform":"scale(" + r + ")" , "transform":"scale(" + r + ")" });
    $("body").height( window.innerHeight ); //修正整数页面高度
    $(".swiper-container, .wrap").height( window.innerHeight / r ); //修正整数页面高度
  }
</script>



<script type="text/javascript">
var springBox = $(".springBox");
var springBoxWidth = springBox.width();
var springBoxHeight = springBox.height();
var icoTimeout_min = 1000;         // 泡温泉最小时间
var icoTimeout_threshold = 1800;   // 泡温泉阈值
var manid = 0;
var score = 0;
//var gameTime = 3000;
var gameTime = 15900;
var time = 15;
var data_Top20 = [];
var icoArray = [
                "http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png",
                "http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png",
                "http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png",
                "http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png",
                "http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png",
                "http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png",
                "http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png",
                "http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png"
                ];
var icoLArray = [
                 "http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png",
                 "http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png",
                 "http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png",
                 "http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png",
                 "http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png",
                 "http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png",
                 "http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png",                 
                 "http://s3img.city.sina.com.cn/activity/common/large/2770b84a7adb0b9e53ecc90504a3dff9.png"                 
                 ];

function icoAct() {
  $(".ico").bind("touchstart mousedown",function (){event.preventDefault(); icoEventHandle($(this))});
}


function icoEventHandle(dom){
  dom.unbind();
  score++;
  var sid = parseInt(dom.attr("sid"));
  var randomTime = icoTimeout_min + Math.random() * icoTimeout_threshold;
  console.log(sid + " t:" + randomTime);
  springAddHandle(sid, randomTime);
  dom.css({opacity: 1, scale: 1}).transition({opacity: 0,scale: 0.8},60);
  setTimeout(function() {
    dom.css({opacity: 0, scale: 1}).transition({opacity: 1},120);
    dom.bind("touchstart mousedown",function (){icoEventHandle(dom)});
  }, randomTime)
}


function springAddHandle(sid, randomTime) {
  var random_x = Math.random() * springBoxWidth;
  var random_y = Math.random() * springBoxHeight;
  random_y = ( sid === 6 ) ? random_y - 50 : random_y ;
  var thisid = manid;
  console.log(thisid);
  
  var html = "";
  html+= '<img src="' + icoLArray[sid-1] + '"class="man man_' + thisid + '"  style="position:absolute; left:' + random_x + 'px; top:' + random_y + 'px; z-index:' + random_y.toFixed(0) +";";
  
  if (Math.random()>0.5) {
    var scaleX = "-webkit-transform:scaleX(-1); transform:scaleX(-1);";
    html+= scaleX;
  } 
  html+= '"/>';
  springBox.append(html);
  
  /* Do not remove man in spring */
  var dom = $(".man_" + thisid);
  setTimeout(function() {
      dom.css({opacity: 1}).transition({opacity: 0},400,function(){
        dom.remove(); //$(".man").remove(dom);
        console.log(thisid + "removed");
    });
  }, randomTime+1000);
  manid++;
}





function reset(){
  manid = 0;
  score = 0;
  time = 16;
  $(".ico").unbind();
  $(".man").remove();
}

function page2(){
  
  $("#p1").css({x: '0px'}).transition({x: '-640px'},800,"cubic-bezier(.83,-0.26,.28,1.28)",function(){
    $("#p2").fadeIn();
  });
}

function gamestart(){
  $(".startBtn").unbind();
  reset();
  $("#p3").show();
  $("#p2").fadeOut(200);
  
  //start
  icoAct();
  
  //gametime
  setTimeout(function () {
    gameover();
  }, gameTime);
  
  startTimer();
}

function startTimer() {
  var timeDom = $(".time");
  t = setInterval(function() {
    time -= 0.1;
    if(time <= 0){
      timeDom.text("0");
      clearInterval(t);
      return;
    }
    timeDom.text(time.toFixed(0));
  }, 100);
}

function gameover() {
  $(".ico").unbind();
  $("#p3").fadeOut();
  $(".score").text(score);
  document.title = "我为国足踢进" + score + "个球，快来玩游戏赢取南京3月31日国足VS突尼斯球票吧！";
  

  /* 进入前20 */
  $(".popup").show();

  
  $("#p2").fadeOut();
  $(".startBtn").unbind().bind("click",function(){
    gamestart();
  });
  
  
}

/**
 * 再来一次按钮
 * 隐藏俩个弹窗，回到第一页
 * TODO 
 */
function onceAgain() {
  $(".popup").fadeOut(200);
  $("#p2").fadeOut(200);
  $("#p1").css({x: '-640px'}).transition({x: '0px'},800,"cubic-bezier(.83,-0.26,.28,1.28)",function(){
  });
}

$(".startBtn").bind("click", function () {
  gamestart();
})
</script>

<script type="text/javascript">
$("#subscribeweixiBtn").click(function(e){
  window.open('http://mp.weixin.qq.com/s?__biz=MjM5Nzg4MzU2MA==&mid=204415784&idx=1&sn=affdafdc566d79092ca4d8865d3d984a#rd');
  e.stopPropagation();  //阻止冒泡
});

$(".submit_btn").unbind().bind("click",function(){
  /* 检查电话号码 */
  var tel = $("#user_tel").val();
  /* 是否填写了电话号码 */
  if (tel == "" | tel == undefined ) {
    var isDirectgetTop20 = confirm("留空的话没法参加活动了，确定不写么？");
    if(!isDirectgetTop20){
      return;
    }
    getTop20Over();
  }
  /* 检测手机号合法 */
  if(!isDirectgetTop20){
    var partten = /^1[3,4,5,8]\d{9}$/;
      if(!partten.test(tel)){alert("请填写正确的手机号！"); return false;}
      /* 上传并得到排名 */
      $("#wrap_3").show();//正在提交...
      
      //提交
      try {
          $.JSONP('http://act.city.sina.com.cn/interface/activity/json_add_signup.php',{
            act_id:10604,
            custom_1:tel,
            custom_2:score
          },function(bm){
            if(bm.error==0){
              /* 获取前10名 */
            getTop20Over();
            }else{
                alert(bm.errmsg);
            }
        }); 
    } catch (e) {
      alert("网络太不好?再试一次吧");
      $("#wrap_3").hide();//隐藏 正在提交...
    } 
      
    
  }
  
  
});
function getTop20Over() {
  $("#wrap_3").hide();//隐藏 正在提交...
  $(".pop2").hide();
  /* 微信弹出页 移除
  $(".weixinCover").fadeIn(200,function(){
    $(".weixinCover").click(function(){
       $(this).unbind("click").fadeOut();
    });
  }); */
}
</script>


</html>
